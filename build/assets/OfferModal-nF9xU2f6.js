import{r as x,j as e}from"./ui-CrM3Hg5W.js";import{C as g,b as N,c as b,B as d,a as M,L as i,I as h,d as S,T as o}from"./index-cRR29Qlm.js";import{D as f,X as w,h as C,Y as P,c as q}from"./icons-Duv7h_B3.js";import"./vendor-BWX1YzKK.js";import"./supabase-BRe8iXyT.js";import"./utils--BulIq_u.js";import"./components-B9TP8a8L.js";function B({isOpen:u,onClose:n,onSubmit:p,product:r,currentUser:D}){const[s,t]=x.useState({offerPrice:r.price,quantity:"1",message:"",deliveryAddress:"",deliveryNotes:"",paymentMethod:"cash"}),[c,m]=x.useState(!1);if(!u)return null;const j=async a=>{a.preventDefault(),m(!0);try{await p(s),n()}catch(y){console.error("Error submitting offer:",y)}finally{m(!1)}},l=s.offerPrice-r.price,v=(l/r.price*100).toFixed(1);return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(g,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-5 h-5"}),"Make an Offer"]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:n,children:e.jsx(w,{className:"w-4 h-4"})})]}),e.jsxs(M,{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:r.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-2",children:[e.jsxs("span",{children:["Seller: ",r.sellerName]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Location: ",r.location]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:["Original Price: ",r.price.toLocaleString()," MMK"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["per ",r.unit]})]})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"offerPrice",children:"Your Offer Price (MMK)"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(h,{id:"offerPrice",type:"number",value:s.offerPrice,onChange:a=>t({...s,offerPrice:Number(a.target.value)}),className:"pl-10",min:"0",step:"1000",required:!0})]}),l!==0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs(S,{variant:l<0?"destructive":"default",children:[l<0?"↓":"↑"," ",Math.abs(l).toLocaleString()," MMK"]}),e.jsxs("span",{className:"text-muted-foreground",children:["(",v,"% ",l<0?"below":"above"," original)"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"quantity",children:"Quantity"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(h,{id:"quantity",value:s.quantity,onChange:a=>t({...s,quantity:a.target.value}),className:"pl-10",placeholder:"e.g., 5 bags, 10 kg",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"message",children:"Message to Seller"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(o,{id:"message",value:s.message,onChange:a=>t({...s,message:a.target.value}),className:"pl-10 min-h-[80px]",placeholder:"Tell the seller about your offer, delivery preferences, or any questions..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"deliveryAddress",children:"Delivery Address"}),e.jsx(o,{id:"deliveryAddress",value:s.deliveryAddress,onChange:a=>t({...s,deliveryAddress:a.target.value}),placeholder:"Enter your delivery address...",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"deliveryNotes",children:"Delivery Notes (Optional)"}),e.jsx(o,{id:"deliveryNotes",value:s.deliveryNotes,onChange:a=>t({...s,deliveryNotes:a.target.value}),placeholder:"Any special delivery instructions..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"paymentMethod",children:"Preferred Payment Method"}),e.jsxs("select",{id:"paymentMethod",value:s.paymentMethod,onChange:a=>t({...s,paymentMethod:a.target.value}),className:"w-full p-2 border rounded-md",children:[e.jsx("option",{value:"cash",children:"Cash on Delivery"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"mobile_payment",children:"Mobile Payment"}),e.jsx("option",{value:"advance",children:"50% Advance, 50% on Delivery"})]})]}),e.jsxs("div",{className:"bg-primary/10 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold",children:"Total Offer Amount:"}),e.jsxs("span",{className:"text-xl font-bold text-primary",children:[(s.offerPrice*parseFloat(s.quantity)||0).toLocaleString()," MMK"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[s.quantity," × ",s.offerPrice.toLocaleString()," MMK"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(d,{type:"button",variant:"outline",onClick:n,className:"flex-1",disabled:c,children:"Cancel"}),e.jsx(d,{type:"submit",className:"flex-1",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending Offer..."]}):"Send Offer"})]})]})]})]})})}export{B as OfferModal};
