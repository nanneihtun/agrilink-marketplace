import{r as i,j as e,a0 as w,a1 as D,a2 as S,a3 as M}from"./ui-CrM3Hg5W.js";import{m as g,B as d,C as o,a as m,d as K}from"./index-cRR29Qlm.js";import{c as y,C as u,J as b,D as _,h as E,U as Y,o as F,M as H,Y as v,p as f}from"./icons-Duv7h_B3.js";import"./vendor-BWX1YzKK.js";import"./supabase-BRe8iXyT.js";import"./utils--BulIq_u.js";import"./components-B9TP8a8L.js";const I=i.forwardRef(({className:a,...n},c)=>e.jsx(w,{ref:c,"data-slot":"tabs",className:g("flex flex-col gap-2",a),...n}));I.displayName=w.displayName;const k=i.forwardRef(({className:a,...n},c)=>e.jsx(D,{ref:c,"data-slot":"tabs-list",className:g("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",a),...n}));k.displayName=D.displayName;const p=i.forwardRef(({className:a,...n},c)=>e.jsx(S,{ref:c,"data-slot":"tabs-trigger",className:g("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...n}));p.displayName=S.displayName;const C=i.forwardRef(({className:a,...n},c)=>e.jsx(M,{ref:c,"data-slot":"tabs-content",className:g("flex-1 outline-none",a),...n}));C.displayName=M.displayName;function G({currentUserId:a,currentUserName:n,currentUserType:c,onBack:A}){const[x,h]=i.useState([]),[P,T]=i.useState(!0),[l,L]=i.useState("all");i.useEffect(()=>{const r=[{id:"1",productId:"1",productName:"Premium Jasmine Rice - 50kg",productImage:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=100&h=100&fit=crop",buyerId:"buyer1",buyerName:"Ma Phyu Phyu",sellerId:"seller1",sellerName:"Ko Thura Min",offerPrice:42e3,originalPrice:45e3,quantity:"10 bags",message:"Interested in bulk purchase. Can we discuss delivery?",deliveryAddress:"123 Main Street, Yangon",paymentMethod:"cash",status:"pending",createdAt:new Date(Date.now()-1728e5).toISOString(),chatId:"chat1"},{id:"2",productId:"2",productName:"Fresh Tomatoes - 25kg",productImage:"https://images.unsplash.com/photo-1592841200221-a6898f307baa?w=100&h=100&fit=crop",buyerId:"buyer2",buyerName:"U Aung Min",sellerId:"seller2",sellerName:"Ma Su Hlaing",offerPrice:17e3,originalPrice:18e3,quantity:"5 crates",message:"Looking for fresh tomatoes for my restaurant.",deliveryAddress:"456 Business District, Mandalay",paymentMethod:"bank_transfer",status:"accepted",createdAt:new Date(Date.now()-432e6).toISOString(),acceptedAt:new Date(Date.now()-3456e5).toISOString(),chatId:"chat2"},{id:"3",productId:"3",productName:"Premium Turmeric Powder - 10kg",productImage:"https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=100&h=100&fit=crop",buyerId:"buyer3",buyerName:"Daw Hla Hla",sellerId:"seller3",sellerName:"Ko Kyaw Zin",offerPrice:24e3,originalPrice:25e3,quantity:"3 sacks",message:"Need for export. Can you provide quality certificate?",deliveryAddress:"789 Export Zone, Yangon",paymentMethod:"advance",status:"completed",createdAt:new Date(Date.now()-864e6).toISOString(),acceptedAt:new Date(Date.now()-7776e5).toISOString(),completedAt:new Date(Date.now()-6048e5).toISOString(),chatId:"chat3"}].filter(t=>t.buyerId===a||t.sellerId===a);h(r),T(!1)},[a]);const O=s=>{switch(s){case"accepted":return"bg-green-100 text-green-800 border-green-300";case"rejected":return"bg-red-100 text-red-800 border-red-300";case"expired":return"bg-gray-100 text-gray-800 border-gray-300";case"completed":return"bg-blue-100 text-blue-800 border-blue-300";case"cancelled":return"bg-orange-100 text-orange-800 border-orange-300";default:return"bg-yellow-100 text-yellow-800 border-yellow-300"}},R=s=>{switch(s){case"accepted":return e.jsx(u,{className:"w-4 h-4"});case"rejected":return e.jsx(f,{className:"w-4 h-4"});case"completed":return e.jsx(u,{className:"w-4 h-4"});case"cancelled":return e.jsx(f,{className:"w-4 h-4"});default:return e.jsx(y,{className:"w-4 h-4"})}},j=x.filter(s=>l==="all"?!0:l==="pending"?s.status==="pending":l==="accepted"?s.status==="accepted":l==="completed"?s.status==="completed":!0),N=s=>s.sellerId===a,q=s=>{h(r=>r.map(t=>t.id===s?{...t,status:"accepted",acceptedAt:new Date().toISOString()}:t))},z=s=>{h(r=>r.map(t=>t.id===s?{...t,status:"rejected"}:t))},B=s=>{h(r=>r.map(t=>t.id===s?{...t,status:"completed",completedAt:new Date().toISOString()}:t))};return P?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Deals Management"})}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Loading deals..."})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Deals Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your offers, negotiations, and completed transactions"})]}),e.jsx(d,{variant:"outline",onClick:A,children:"Back"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(o,{children:e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold",children:x.filter(s=>s.status==="pending").length})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Accepted"}),e.jsx("p",{className:"text-2xl font-bold",children:x.filter(s=>s.status==="accepted").length})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold",children:x.filter(s=>s.status==="completed").length})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Value"}),e.jsxs("p",{className:"text-2xl font-bold",children:[x.filter(s=>s.status==="completed").reduce((s,r)=>s+(r.offerPrice*parseFloat(r.quantity)||0),0).toLocaleString()," MMK"]})]})]})})})]}),e.jsxs(I,{value:l,onValueChange:L,children:[e.jsxs(k,{className:"grid w-full grid-cols-4",children:[e.jsx(p,{value:"all",children:"All Deals"}),e.jsx(p,{value:"pending",children:"Pending"}),e.jsx(p,{value:"accepted",children:"Accepted"}),e.jsx(p,{value:"completed",children:"Completed"})]}),e.jsx(C,{value:l,className:"space-y-4",children:j.length===0?e.jsx(o,{children:e.jsxs(m,{className:"text-center py-12",children:[e.jsx(E,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No deals found"}),e.jsx("p",{className:"text-muted-foreground",children:l==="all"?"You don't have any deals yet. Start by making an offer on a product!":`No ${l} deals found.`})]})}):j.map(s=>e.jsx(o,{className:"hover:shadow-md transition-shadow",children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:s.productImage,alt:s.productName,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.productName}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-4 h-4"}),N(s)?s.buyerName:s.sellerName]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-4 h-4"}),new Date(s.createdAt).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Offer Price:"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-lg",children:[s.offerPrice.toLocaleString()," MMK"]}),s.offerPrice!==s.originalPrice&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Original: ",s.originalPrice.toLocaleString()," MMK"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Quantity:"}),e.jsx("span",{className:"font-medium",children:s.quantity})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Amount:"}),e.jsxs("span",{className:"font-bold text-primary text-lg",children:[(s.offerPrice*parseFloat(s.quantity)||0).toLocaleString()," MMK"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Payment:"}),e.jsx("span",{className:"text-sm",children:s.paymentMethod==="cash"?"Cash on Delivery":s.paymentMethod==="bank_transfer"?"Bank Transfer":s.paymentMethod==="mobile_payment"?"Mobile Payment":s.paymentMethod==="advance"?"50% Advance, 50% on Delivery":s.paymentMethod})]}),s.deliveryAddress&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(H,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Delivery Address:"}),e.jsx("p",{className:"text-sm",children:s.deliveryAddress})]})]}),s.message&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Message:"}),e.jsx("p",{className:"text-sm",children:s.message})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3",children:[e.jsxs(K,{className:O(s.status),children:[R(s.status),e.jsx("span",{className:"ml-1 capitalize",children:s.status})]}),s.status==="pending"&&N(s)&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",onClick:()=>q(s.id),children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"Accept"]}),e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>z(s.id),children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"Reject"]})]}),s.status==="accepted"&&e.jsxs(d,{size:"sm",onClick:()=>B(s.id),children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"Mark Completed"]}),s.status==="completed"&&e.jsxs(d,{size:"sm",variant:"outline",children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),"Leave Review"]}),s.chatId&&e.jsxs(d,{size:"sm",variant:"outline",children:[e.jsx(v,{className:"w-4 h-4 mr-1"}),"View Chat"]})]})]})})},s.id))})]})]})}export{G as DealsManagement};
